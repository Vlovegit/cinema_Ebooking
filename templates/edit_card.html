{% extends 'base.html' %}
{% load static %}
{% block content %} 
<link rel="stylesheet" href="{% static 'css/registration.css' %}">
<link rel="stylesheet" href="{% static 'css/bootstrap.css' %}">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css" rel="stylesheet"/>
<div class="container h-75  pt-5">
<div class="row ml-auto">
<div class="col ml-auto">

<style>
  body {
    font-family: Arial, sans-serif;
  }
  
  form {
    width: 1000px;
    margin: 0 auto;
  }
  
  fieldset {
    border: none;
  }
  
  legend {
    font-size: 1.5em;
    font-weight: bold;
  }
  
  label {
    display: inline-block;
    width: 100px;
    text-align: right;
    margin-right: 10px;
  }
  
  input[type="text"], select {
    font-size: 1em;
    padding: 5px;
    border-radius: 5px;
    border: 1px solid #ccc;
    width: 250px;
    margin-bottom: 10px;
  }
  
  #add_card {
    background-color: #4CAF50;
    color: white;
    padding: 10px 20px;
    border: none;
    border-radius: 5px;
    cursor: pointer;
  }
  
  #add_card:hover {
    background-color: #3e8e41;
  }
  
  ul#credit_cards {
    margin: 0;
    padding: 0;
    list-style-type: none;
  }
  
  ul#credit_cards li {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 10px;
    padding: 10px;
    background-color: #f9f9f9;
    border: 1px solid #ddd;
    border-radius: 5px;
  }
  
  ul#credit_cards li div {
    flex: 1;
    margin-right: 20px;
  }
  
  ul#credit_cards li div:last-child {
    margin-right: 0;
  }
  
  ul#credit_cards li label {
    width: auto;
    margin-right: 0;
  }
  
  ul#credit_cards li button {
    background-color: #f44336;
    color: white;
    padding: 5px 10px;
    border: none;
    border-radius: 5px;
    cursor: pointer;
  }
  
  ul#credit_cards li button:hover {
    background-color: #da190b;
  }

  /* Style for the "Add Credit Card" button */
.add-card-button {
  background-color: #4CAF50; /* Green background */
  border: none; /* Remove border */
  color: white; /* White text */
  padding: 10px 20px; /* Add padding */
  text-align: center; /* Center-align text */
  text-decoration: none; /* Remove underline */
  display: inline-block; /* Display as a block element */
  font-size: 16px; /* Font size */
  margin-bottom: 20px; /* Add bottom margin */
}

/* Style for the "Save Changes" button */
.save-changes-button {
  background-color: #008CBA; /* Blue background */
  border: none; /* Remove border */
  color: white; /* White text */
  padding: 10px 20px; /* Add padding */
  text-align: center; /* Center-align text */
  text-decoration: none; /* Remove underline */
  display: inline-block; /* Display as a block element */
  font-size: 16px; /* Font size */
  margin-bottom: 20px; /* Add bottom margin */
}
  
</style>
<div class="bg-dark" style="border-radius: 75px;">
   <div class="card-body p-5">
      
      <h1 class="text-uppercase text-center mb-5 text-white">Add/Edit Payment Card Details</h1>
         </br></br>
         <form method="post" action="edit_card">
            {% csrf_token %}
          
            <h2 class="text-white">Payment Cards:</h2>
          
            <ul id="credit_cards">
              {% for card in cards %}
                
                <li>
                  <div>
                    <label for="cardHolderName_{{ forloop.counter }}">Cardholder Name:</label>
                    <input type="text" required="true" id="cardHolderName_{{ forloop.counter }}" name="cardHolderName_{{ forloop.counter }}" value="{{ card.cardHolderName }}">
                  </div>
          
                  <div>
                    <label for="cardNum_{{ forloop.counter }}">Card Number:</label>
                    <input type="text" required="true" id="cardNum_{{ forloop.counter }}" name="cardNum_{{ forloop.counter }}" value="{{ card.cardNum }}">
                  </div>
          
                  <div>
                    <label for="expiryDate_{{ forloop.counter }}">Expiration Date:</label>
                    <input type="text" required="true" id="expiryDate_{{ forloop.counter }}" name="expiryDate_{{ forloop.counter }}" value="{{ card.expiryDate }}">
                  </div>
          
                  <button type="button" onclick="deleteCard(this)">Delete</button>
                </li>
                
              {% endfor %}
            </ul>
          
            <div>
              <button class="add-card-button" type="button" onclick="addCard()">Add Credit Card</button>
            </div>
          
            <div>
              <button class="save-changes-button" type="submit">Save Changes</button>
            </div>
            {% if messages %}
            {% for message in messages %}
              <h3 class ="text-white">{{message}}</h3>
            {% endfor %}
        {% endif %}
            <script>
              function deleteCard(button) {
                var li = button.parentNode;
                var ul = li.parentNode;
                ul.removeChild(li);
              }
          
              function addCard() {
                var cards_list = document.getElementById("credit_cards");
                var num_cards = cards_list.getElementsByTagName("li").length;
                
                if (num_cards >= 3) {
                  alert("You can only add up to 3 cards.");
                  return;
                }
              
                var new_card_id = (num_cards + 1);
                var new_card_html = `
                  <li>
                    <div>
                      <label for="cardHolderName_${new_card_id}">Cardholder Name:</label>
                      <input type="text" required="true" id="cardHolderName_${new_card_id}" name="cardHolderName_${new_card_id}">
                    </div>
              
                    <div>
                      <label for="cardNum_${new_card_id}">Card Number:</label>
                      <input type="text" required="true" id="cardNum_${new_card_id}" name="cardNum_${new_card_id}" maxlength="16">
                    </div>
              
                    <div>
                      <label for="expiryDate_${new_card_id}">Expiration Date:</label>
                      <input type="text" required="true" id="expiryDate_${new_card_id}" name="expiryDate_${new_card_id}" placeholder="MM/YY">
                    </div>
              
                    <button type="button" onclick="deleteCard(this)">Delete</button>
                  </li>
                `;
                cards_list.innerHTML += new_card_html;
              }
              
            </script>
          
    </div>
</div>
</div>
</div>
</div>
    
{% endblock %}